import regex as re
import pandas as pd

codes = "G2 Hypertensive disease G20 Essential hypertension G200 Malignant essential hypertension G201 Benign essential hypertension G202 Systolic hypertension G203 Diastolic hypertension G20z Essential hypertension NOS G24 Secondary hypertension G240 Secondary malignant hypertension G240z Secondary malignant hypertension NOS G241 Secondary benign hypertension G241z Secondary benign hypertension NOS G244 Hypertension secondary to endocrine disorders G24z Secondary hypertension NOS G24z0 Secondary renovascular hypertension NOS G24zz Secondary hypertension NOS G25 Stage 1 hypertension (NICE - Nat Ins for Hth Clin Excl 2011) G250 Stage 1 hyperten (NICE 2011) without evidnce end organ damge G251 Stage 1 hyperten (NICE 2011) with evidnce end organ damge G26 Severe hypertension (Nat Inst for Health Clinical Ex 2011) G28 Stage 2 hypertension (NICE - Nat Ins for Hth Clin Excl 2011) G2y Other specified hypertensive disease G2z Hypertensive disease NOS Gyu2 [X]Hypertensive diseases 76 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 Gyu20 [X]Other secondary hypertension C10 Diabetes mellitus C109J Insulin treated Type 2 diabetes mellitus C109K Hyperosmolar non-ketotic state in type 2 diabetes mellitus C10C Diabetes mellitus autosomal dominant C10D Diabetes mellitus autosomal dominant type 2 C10E Type 1 diabetes mellitus C10E0 Type 1 diabetes mellitus with renal complications C10E1 Type 1 diabetes mellitus with ophthalmic complications C10E2 Type 1 diabetes mellitus with neurological complications C10E3 Type 1 diabetes mellitus with multiple complications C10E4 Unstable type 1 diabetes mellitus C10E5 Type 1 diabetes mellitus with ulcer C10E6 Type 1 diabetes mellitus with gangrene C10E7 Type 1 diabetes mellitus with retinopathy C10E8 Type 1 diabetes mellitus - poor control C10E9 Type 1 diabetes mellitus maturity onset C10EA Type 1 diabetes mellitus without complication C10EB Type 1 diabetes mellitus with mononeuropathy C10EC Type 1 diabetes mellitus with polyneuropathy C10ED Type 1 diabetes mellitus with nephropathy C10EE Type 1 diabetes mellitus with hypoglycaemic coma C10EF Type 1 diabetes mellitus with diabetic cataract C10EG Type 1 diabetes mellitus with peripheral angiopathy C10EH Type 1 diabetes mellitus with arthropathy C10EJ Type 1 diabetes mellitus with neuropathic arthropathy C10EK Type 1 diabetes mellitus with persistent proteinuria C10EL Type 1 diabetes mellitus with persistent microalbuminuria C10EM Type 1 diabetes mellitus with ketoacidosis C10EN Type 1 diabetes mellitus with ketoacidotic coma C10EP Type 1 diabetes mellitus with exudative maculopathy C10EQ Type 1 diabetes mellitus with gastroparesis C10ER Latent autoimmune diabetes mellitus in adult C10F Type 2 diabetes mellitus C10F0 Type 2 diabetes mellitus with renal complications C10F1 Type 2 diabetes mellitus with ophthalmic complications C10F2 Type 2 diabetes mellitus with neurological complications C10F3 Type 2 diabetes mellitus with multiple complications C10F4 Type 2 diabetes mellitus with ulcer C10F5 Type 2 diabetes mellitus with gangrene C10F6 Type 2 diabetes mellitus with retinopathy C10F7 Type 2 diabetes mellitus - poor control C10F9 Type 2 diabetes mellitus without complication C10FA Type 2 diabetes mellitus with mononeuropathy C10FB Type 2 diabetes mellitus with polyneuropathy C10FC Type 2 diabetes mellitus with nephropathy C10FD Type 2 diabetes mellitus with hypoglycaemic coma C10FE Type 2 diabetes mellitus with diabetic cataract C10FF Type 2 diabetes mellitus with peripheral angiopathy C10FG Type 2 diabetes mellitus with arthropathy C10FH Type 2 diabetes mellitus with neuropathic arthropathy 77 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 C10FJ Insulin treated Type 2 diabetes mellitus C10FK Hyperosmolar non-ketotic state in type 2 diabetes mellitus C10FL Type 2 diabetes mellitus with persistent proteinuria C10FM Type 2 diabetes mellitus with persistent microalbuminuria C10FN Type 2 diabetes mellitus with ketoacidosis C10FP Type 2 diabetes mellitus with ketoacidotic coma C10FQ Type 2 diabetes mellitus with exudative maculopathy C10FR Type 2 diabetes mellitus with gastroparesis C10FS Maternally inherited diabetes mellitus C10G Secondary pancreatic diabetes mellitus C10G0 Secondary pancreatic diabetes mellitus without complication C10H Diabetes mellitus induced by non-steroid drugs C10H0 DM induced by non-steroid drugs without complication C10M Lipoatrophic diabetes mellitus C10M0 Lipoatrophic diabetes mellitus without complication C10N Secondary diabetes mellitus C10N0 Secondary diabetes mellitus without complication C10N1 Cystic fibrosis related diabetes mellitus PKyP Diab insipidus,diab mell,optic atrophy and deafness Fyu55 [X]Other transnt cerebral ischaemic attacks+related syndroms G3 Ischaemic heart disease G30 Acute myocardial infarction G300 Acute anterolateral infarction G301 Other specified anterior myocardial infarction G3010 Acute anteroapical infarction G3011 Acute anteroseptal infarction G301z Anterior myocardial infarction NOS G302 Acute inferolateral infarction G303 Acute inferoposterior infarction G304 Posterior myocardial infarction NOS G305 Lateral myocardial infarction NOS G306 True posterior myocardial infarction G307 Acute subendocardial infarction G3070 Acute non-Q wave infarction G3071 Acute non-ST segment elevation myocardial infarction G308 Inferior myocardial infarction NOS G309 Acute Q-wave infarct G30B Acute posterolateral myocardial infarction G30X Acute transmural myocardial infarction of unspecif site G30X0 Acute ST segment elevation myocardial infarction G30y Other acute myocardial infarction G30y0 Acute atrial infarction G30y1 Acute papillary muscle infarction G30y2 Acute septal infarction G30yz Other acute myocardial infarction NOS G30z Acute myocardial infarction NOS G31 Other acute and subacute ischaemic heart disease G311 Preinfarction syndrome G3110 Myocardial infarction aborted G3111 Unstable angina G3112 Angina at rest G3113 Refractory angina G3114 Worsening angina G3115 Acute coronary syndrome G311z Preinfarction syndrome NOS 78 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 G312 Coronary thrombosis not resulting in myocardial infarction G31y Other acute and subacute ischaemic heart disease G31y0 Acute coronary insufficiency G31y1 Microinfarction of heart G31y2 Subendocardial ischaemia G31y3 Transient myocardial ischaemia G31yz Other acute and subacute ischaemic heart disease NOS G32 Old myocardial infarction G33 Angina pectoris G330 Angina decubitus G3300 Nocturnal angina G330z Angina decubitus NOS G33z Angina pectoris NOS G33z0 Status anginosus G33z1 Stenocardia G33z2 Syncope anginosa G33z3 Angina on effort G33z4 Ischaemic chest pain G33z5 Post infarct angina G33z6 New onset angina G33z7 Stable angina G33zz Angina pectoris NOS G34 Other chronic ischaemic heart disease G340 Coronary atherosclerosis G3400 Single coronary vessel disease G3401 Double coronary vessel disease G342 Atherosclerotic cardiovascular disease G343 Ischaemic cardiomyopathy G344 Silent myocardial ischaemia G34y Other specified chronic ischaemic heart disease G34y0 Chronic coronary insufficiency G34y1 Chronic myocardial ischaemia G34yz Other specified chronic ischaemic heart disease NOS G34z Other chronic ischaemic heart disease NOS G34z0 Asymptomatic coronary heart disease G35 Subsequent myocardial infarction G350 Subsequent myocardial infarction of anterior wall G351 Subsequent myocardial infarction of inferior wall G353 Subsequent myocardial infarction of other sites G35X Subsequent myocardial infarction of unspecified site G38 Postoperative myocardial infarction G380 Postoperative transmural myocardial infarction anterior wall G381 Postoperative transmural myocardial infarction inferior wall G382 Postoperative transmural myocardial infarction other sites G383 Postoperative transmural myocardial infarction unspec site G384 Postoperative subendocardial myocardial infarction G38z Postoperative myocardial infarction, unspecified G39 Coronary microvascular disease G3y Other specified ischaemic heart disease G3z Ischaemic heart disease NOS G61 Intracerebral haemorrhage G610 Cortical haemorrhage G611 Internal capsule haemorrhage G612 Basal nucleus haemorrhage G613 Cerebellar haemorrhage 79 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 G614 Pontine haemorrhage G615 Bulbar haemorrhage G616 External capsule haemorrhage G618 Intracerebral haemorrhage, multiple localized G619 Lobar cerebral haemorrhage G61X Intracerebral haemorrhage in hemisphere, unspecified G61X0 Left sided intracerebral haemorrhage, unspecified G61X1 Right sided intracerebral haemorrhage, unspecified G61z Intracerebral haemorrhage NOS G63y0 Cerebral infarct due to thrombosis of precerebral arteries G63y1 Cerebral infarction due to embolism of precerebral arteries G64 Cerebral arterial occlusion G640 Cerebral thrombosis G6400 Cerebral infarction due to thrombosis of cerebral arteries G641 Cerebral embolism G6410 Cerebral infarction due to embolism of cerebral arteries G64z Cerebral infarction NOS G64z0 Brainstem infarction G64z1 Wallenberg syndrome G64z2 Left sided cerebral infarction G64z3 Right sided cerebral infarction G64z4 Infarction of basal ganglia G65 Transient cerebral ischaemia G650 Basilar artery syndrome G651 Vertebral artery syndrome G6510 Vertebro-basilar artery syndrome G652 Subclavian steal syndrome G653 Carotid artery syndrome hemispheric G654 Multiple and bilateral precerebral artery syndromes G656 Vertebrobasilar insufficiency G657 Carotid territory transient ischaemic attack G65y Other transient cerebral ischaemia G65z Transient cerebral ischaemia NOS G65z0 Impending cerebral ischaemia G65z1 Intermittent cerebral ischaemia G65zz Transient cerebral ischaemia NOS G66 Stroke and cerebrovascular accident unspecified G660 Middle cerebral artery syndrome G661 Anterior cerebral artery syndrome G662 Posterior cerebral artery syndrome G663 Brain stem stroke syndrome G664 Cerebellar stroke syndrome G665 Pure motor lacunar syndrome G666 Pure sensory lacunar syndrome G667 Left sided CVA G668 Right sided CVA G6760 Cereb infarct due cerebral venous thrombosis, nonpyogenic G6W Cereb infarct due unsp occlus/stenos precerebr arteries G6X Cerebrl infarctn due/unspcf occlusn or sten/ cerebrl artrs G73 Other peripheral vascular disease G734 Peripheral arterial disease G73y Other specified peripheral vascular disease G73z Peripheral vascular disease NOS G73z0 Intermittent claudication G73zz Peripheral vascular disease NOS 80 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 Gyu3 [X]Ischaemic heart diseases Gyu30 [X]Other forms of angina pectoris Gyu32 [X]Other forms of acute ischaemic heart disease Gyu33 [X]Other forms of chronic ischaemic heart disease Gyu34 [X]Acute transmural myocardial infarction of unspecif site Gyu35 [X]Subsequent myocardial infarction of other sites Gyu36 [X]Subsequent myocardial infarction of unspecified site Gyu62 [X]Other intracerebral haemorrhage Gyu63 [X]Cerebrl infarctn due/unspcf occlusn or sten/ cerebrl artrs Gyu64 [X]Other cerebral infarction Gyu65 [X]Occlusion and stenosis of other precerebral arteries Gyu66 [X]Occlusion and stenosis of other cerebral arteries Gyu6F [X]Intracerebral haemorrhage in hemisphere, unspecified Gyu6G [X]Cereb infarct due unsp occlus/stenos precerebr arteries Gyu74 [X]Other specified peripheral vascular diseases ZV12D [V]Personal history of transient ischaemic attack 4G4 O/E: renal calculus 4G41 O/E: oxalate renal calculus 4G42 O/E: phosphate -staghorn-stone 4G43 O/E: uric acid renal calculus 4G44 O/E: cystine renal calculus 4G4Z O/E: renal stone NOS C3411 Uric acid nephrolithiasis K12 Calculus of kidney and ureter K120 Calculus of kidney K1200 Staghorn calculus K120z Renal calculus NOS K122 Calculus of kidney with calculus of ureter PD31 Congenital calculus of kidney K20 Benign prostatic hypertrophy K200 Prostatic hyperplasia unspecified K201 Prostatic hyperplasia of the lateral lobe K202 Prostatic hyperplasia of the medial lobe K20z Prostatic hyperplasia NOS C34 Gout C340 Gouty arthropathy C341 Gouty nephropathy C3410 Gouty nephropathy unspecified C341z Gouty nephropathy NOS C342 Idiopathic gout C343 Lead-induced gout C344 Drug-induced gout C345 Gout due to impairment of renal function C346 Acute exacerbation of gout C34y Other specified gouty manifestation C34y0 Gouty tophi of ear C34y1 Gouty tophi of heart C34y2 Gouty tophi of other sites C34y3 Gouty iritis C34y4 Gouty neuritis C34y5 Gouty tophi of hand C34y6 Gouty tophi of toe C34yz Other specified gouty manifestation NOS C34z Gout NOS N00 Diffuse diseases of connective tissue N000 Systemic lupus erythematosus N0000 Disseminated lupus erythematosus N0001 Libman-Sacks disease 81 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 N0002 Drug-induced systemic lupus erythematosus N0003 Systemic lupus erythematosus with organ or sys involv N0004 Systemic lupus erythematosus with pericarditis N0005 Neonatal lupus erythematosus N0006 Cerebral lupus N000z Systemic lupus erythematosus NOS N001 Scleroderma N0010 Progressive systemic sclerosis N0011 CREST syndrome N0012 Systemic sclerosis induced by drugs and chemicals N002 Sicca (Sjogren’s) syndrome N003 Dermatomyositis N0030 Juvenile dermatomyositis N0031 Dermatopolymyositis in neoplastic disease N003X Dermatopolymyositis, unspecified N004 Polymyositis N005 Adult Still’s Disease N006 Antiphospholipid syndrome N00y Other specified diffuse collagen diseases N00y0 Eosinophilic fasciitis N00y1 Fibrosclerosis systemic N00z Collagen disease NOS Nyu4 [X]Systemic connective tissue disorders Nyu40 [X]Other conditions related to polyarteritis nodosa Nyu41 [X]Other giant cell arteritis Nyu42 [X]Other specified necrotizing vasculopathies Nyu43 [X]Other forms of systemic lupus erythematosus Nyu44 [X]Other dermatomyositis Nyu45 [X]Other forms of systemic sclerosis Nyu46 [X]Other overlap syndromes Nyu47 [X]Other systemic diseases of connective tissue Nyu48 [X]Dermato(poly)myositis in neoplastic disease CE Nyu4C [X]Systemic disorders/connective tissue in other diseases CE Nyu4D [X]Necrotising vasculopathy, unspecified Nyu4E [X]Dermatopolymyositis, unspecified Nyu4F [X]Mixed connective tissue disease d6 LITHIUM SALTS d61 LITHIUM CARBONATE d611 CAMCOLIT 250mg tablets d612 CAMCOLIT 400mg tablets d613 LISKONUM 450mg m/r tablets d614 PHASAL 300mg m/r tablets d615 PRIADEL 400mg m/r tablets d616 PRIADEL 200mg m/r tablets d617 PRIADEL 520mg/5mL sugar free liquid d618 LITHIUM CARBONATE 520mg/5mL sugar free liquid d619 LITHONATE 400mg m/r tablets d61s LITHIUM CARBONATE 200mg m/r tablets d61v LITHIUM CARBONATE 250mg tablets d61w LITHIUM CARBONATE 400mg tablets d61x LITHIUM CARBONATE 450mg m/r tablets d61y LITHIUM CARBONATE 300mg m/r tablets d61z LITHIUM CARBONATE 400mg m/r tablets d62 LITHIUM CITRATE d621 LITAREX 564mg m/r tablets d622 LI-LIQUID 5.4mmol/5mL liquid d623 LI-LIQUID 10.8mmol/5mL liquid d624 PRIADEL 520mg/5mL sugar free liquid 150mL d625 PRIADEL 520mg/5mL sugar free liquid 82 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 d62w LITHIUM CITRATE 520mg/5mL sugar free liquid d62x LITHIUM CITRATE 5.4mmol/5mL liquid d62y LITHIUM CITRATE 10.8mmol/5mL liquid d62z LITHIUM CITRATE 564mg m/r tablets h82 CICLOSPORIN h821 SANDIMMUN 100mg/mL sugar free oral solution h822 SANDIMMUN 50mg/1mL injection h823 SANDIMMUN 250mg/5mL injection h824 SANDIMMUN 25mg capsules h825 SANDIMMUN 100mg capsules h826 CICLOSPORIN 25mg capsules h827 CICLOSPORIN 100mg capsules h828 SANDIMMUN 50mg capsules h829 CICLOSPORIN 50mg capsules h82A NEORAL 25mg capsules h82B NEORAL 50mg capsules h82C NEORAL 100mg capsules h82D NEORAL 100mg/mL sugar free oral solution h82E CICLOSPORIN 10mg capsules h82F NEORAL 10mg capsules h82G SANGCYA 100mg/mL oral solution h82H DEXIMUNE 25mg capsules h82I DEXIMUNE 50mg capsules h82J DEXIMUNE 100mg capsules h82K CAPIMUNE 25mg capsules h82L CAPIMUNE 50mg capsules h82M CAPIMUNE 100mg capsules h82N CAPSORIN 25mg capsules h82O CAPSORIN 50mg capsules h82P CAPSORIN 100mg capsules h82Q IKERVIS 1mg/mL single-use eye drops 0.3mL h82w CICLOSPORIN 1mg/mL single-use eye drops h82x CICLOSPORIN 100mg/mL sugar free oral solution h82y CICLOSPORIN 50mg/1mL injection h82z CICLOSPORIN 250mg/5mL injection h83 TACROLIMUS h831 TACROLIMUS 1mg capsules h832 TACROLIMUS 5mg capsules h833 TACROLIMUS 5mg/1mL intravenous infusion concentrate h834 PROGRAF 1mg capsules h835 PROGRAF 5mg capsules h836 PROGRAF 5mg/1mL intravenous infusion concentrate h837 PROGRAF 0.5mg capsules h838 ADVAGRAF 0.5mg m/r capsules h839 ADVAGRAF 1mg m/r capsules h83A ADVAGRAF 5mg m/r capsules h83B ADVAGRAF 3mg m/r capsules h83C MODIGRAF 200micrograms/sachet granules for oral suspension h83D MODIGRAF 1mg/sachet granules for oral suspension h83E ADOPORT 500micrograms capsules h83F ADOPORT 1mg capsules h83G ADOPORT 5mg capsules h83H VIVADEX 500micrograms capsules h83I VIVADEX 1mg capsules h83J VIVADEX 5mg capsules h83K CAPEXION 500micrograms capsules h83L CAPEXION 1mg capsules h83M CAPEXION 5mg capsules h83N PERIXIS 500micrograms capsules 83 // National Chronic Kidney Disease Audit - National Report (Part 1) January 2017 h83O PERIXIS 1mg capsules h83P PERIXIS 5mg capsules h83Q ENVARSUS 750micrograms m/r tablets h83R ENVARSUS 1mg m/r tablets h83S ENVARSUS 4mg m/r tablets h83T ADOPORT 0.75mg capsules h83U ADOPORT 2mg capsules h83o TACROLIMUS 2mg capsules h83p TACROLIMUS 750micrograms capsules h83q TACROLIMUS 4mg m/r tablets h83r TACROLIMUS 1mg m/r tablets h83s TACROLIMUS 750micrograms m/r tablets h83t TACROLIMUS 1mg/sachet granules for oral suspension h83u TACROLIMUS 200micrograms/sachet granules for oral suspension h83v TACROLIMUS 3mg m/r capsules h83w TACROLIMUS 5mg m/r capsules h83x TACROLIMUS 1mg m/r capsules h83y TACROLIMUS 500microgram m/r capsules h83z TACROLIMUS 0.5mg capsules K04 Acute renal failure K040 Acute renal tubular necrosis K041 Acute renal cortical necrosis K042 Acute renal medullary necrosis K043 Acute drug-induced renal failure K0430 Acute renal failure due to ACE inhibitor K0431 Acute renal failure induced by aminoglycoside K0432 Acute renal failure induced by cisplatin K0433 Acute renal failure induced by cyclosporin A K0434 Acute renal failure induced by non-steroid antiinflamm drug K044 Acute renal failure due to urinary obstruction K045 Acute renal failure due to non-traumatic rhabdomyolysis K046 Acute renal failure induced by toxin K0460 Acute renal failure induced by animal toxin K0461 Acute renal failure induced by plant toxin K047 Acute renal failure induced by heavy metal K048 Acute renal failure induced by poison K049 Acute renal failure induced by radiographic contrast media K04A Acute renal failure induced by solvent K04B Acute renal failure due to traumatic rhabdomyolysis K04C Acute kidney injury stage 1 K04D Acute kidney injury stage 2 K04E Acute kidney injury stage 3 K04y Other acute renal failure K04z Acute renal failure NOS"

pattern = "(?:[a-z]|[A-Z])+[0-9]\S*"

matches = re.findall(pattern, codes)
pd.Series(matches, name="read_code").to_csv("analysis/at_risk_of_ckd_read_codes.csv")